%设置页面边距（word标准页面）
\documentclass[a4paper]{article}
\usepackage{geometry}
\geometry{a4paper,left=2.7cm,right=2.7cm,top=2.54cm,bottom=2.54cm}

%导入ctex包
\usepackage[UTF8,heading=true]{ctex}

%设置摘要格式
\usepackage{abstract}
\setlength{\abstitleskip}{0em}
\setlength{\absleftindent}{0pt}
\setlength{\absrightindent}{0pt}
\setlength{\absparsep}{0em}
\renewcommand{\abstractname}{\textbf{\zihao{4}{摘要}}}
\renewcommand{\abstracttextfont}{\zihao{-4}} %设置摘要正文字号

%设置页眉和页脚，只显示页脚居中页码
\usepackage{fancyhdr}
\pagestyle{plain}

%调用数学公式包
\usepackage{amssymb}
\usepackage{amsmath}

%调用浮动包
\usepackage{float}
\usepackage{subfig}
\captionsetup[figure]{labelsep=space} %去除图标题的冒号
\captionsetup[table]{labelsep=space} %去除表格标题的冒号
%设置标题格式
\ctexset {
	%设置一级标题的格式
	section = {
		name={,、},
		number=\chinese{section}, %设置中文版的标题
		aftername=,
	},
	%设置三级标题的格式
	subsubsection = {
		format += \zihao{-4} % 设置三级标题的字号
	}
}


%使得英文字体都为Time NewTown
%\usepackage{times}

%图片包导入
\usepackage{graphicx}
\graphicspath{{figures/}} %图片在当前目录下的figures目录

%参考文献包引入
\usepackage{cite}
\usepackage[numbers,sort&compress]{natbib}

%代码格式
\usepackage{listings}
\usepackage{graphicx}%写入python代码
\usepackage{pythonhighlight}%python代码高亮显示
\lstset{
	%numbers=left, %设置行号位置
	%	numberstyle=\tiny, %设置行号大小
	keywordstyle=\color{blue}, %设置关键字颜色
	commentstyle=\color[cmyk]{1,0,1,0}, %设置注释颜色
	escapeinside=``, %逃逸字符(1左面的键)，用于显示中文
	breaklines, %自动折行
	extendedchars=false, %解决代码跨页时，章节标题，页眉等汉字不显示的问题
	xleftmargin=1em,xrightmargin=1em, aboveskip=1em, %设置边距
	tabsize=4, %设置tab空格数
	showspaces=false %不显示空格
}


\renewcommand{\refname}{}

%item包
\usepackage{enumitem}

%表格加粗
\usepackage{booktabs}

%设置表格间距
\usepackage{caption}

%允许表格长跨页
\usepackage{longtable}

%伪代码用到的宏包
\usepackage{algorithmic}
\usepackage{algorithm}

%正文区
\title{“板凳龙” 运动系统的建模与优化}
\date{} %不显示日期

%文档
\begin{document}
	\maketitle
	\vspace{-6em} %设置摘要与标题的间距
	\zihao{-4} %设置正文字号
	%摘要部分
	\begin{abstract}
		“板凳龙”是浙闽地区的传统民俗活动，其舞龙队能够将上百条板凳螺旋式盘绕形成巨龙。在“板凳龙”的舞龙过程中，舞龙队应当保持较小的间距和较快的行进速度，以增强观赏性；同时舞龙队路径的螺距与速度需要满足一定约束条件，以保证安全。在题设要求下，通过对“板凳龙”问题的进行分析与适当建模，我们给出了所有指定时刻把手的坐标和速度，在等距螺线下求出了板凳龙的最小螺距和最大速度。

		\hspace{0.2em}\textbf{针对问题一}，以等距螺线为中心建立了\textbf{极坐标系}，用\textbf{参数方程}刻画舞龙队的行进位置和速度。首先，建立等距螺线和龙头速度间关系的\textbf{微分方程模型}，利用\textbf{积分法}求解出了\textbf{舞龙队龙头的坐标关于行进时间的解析式}；然后，基于已知的把手位置，建立了舞龙队伍的\textbf{几何模型}，通过不断对后一把手进行\textbf{二分查找}，\textbf{迭代}查找确定了舞龙队所有把手的坐标；接着，用\textbf{微分方程转化为差分方程}的\textbf{微元法}，得到了舞龙队在各个位置下的速度。

		\textbf{针对问题二}，建立了以舞龙队\textbf{最长运动时间}为\textbf{决策变量和目标函数}的\textbf{复杂单目标优化模型}。针对板凳不能碰撞的约束条件，使用\textbf{证明与解析几何方法}将其转化为\textbf{线段相交}约束，用\textbf{跨立实验}判断是否相交；接着提出了适用于本模型的\textbf{拟粒子群算法}求解出优化结果，得到了从起始位置开始舞龙队最多可以前进\textbf{412.48s}。通过可视化和灵敏度分析对模型进行了验证。/*TODO 敏感分析 可视化*/最后使用问题一的模型与算法完成了位置和速度的求解。

		\textbf{针对问题三}，建立了以\textbf{等距螺线螺距}为\textbf{目标函数}的\textbf{单目标优化模型}。使用了问题二建立的模型和算法，求解出特定螺距下龙头与原点的\textbf{最小距离}。通过\textbf{可视化与回归分析}确认了螺距-龙头与原点最小距离函数的\textbf{单调性}。最后利用\textbf{二分查找}求解出满足题目要求的最小螺距为\textbf{46.269531cm}。/* TODO 回归？*/

		\textbf{针对问题四}，首先，按照题目要求计算出了舞龙队盘入路线、盘出路线和掉头路线的圆弧位置，利用\textbf{解析几何和计算几何}的方法确定了舞龙队的\textbf{掉头路线方程}。然后，取\textbf{时间作为参数}，建立了舞龙队\textbf{行进路线的参数方程}。最后，利用\textbf{二分查找算法}和\textbf{微元法}，计算出了舞龙队各把手在各个时刻下的位置和速度的数值解。

		\textbf{针对问题五}，...\\
		%关键词（上文最后一段要用“\\”换行）
		\newline
		\noindent{\textbf{关键词：} \textbf{关键词1}\quad   \textbf{关键词2}\quad \textbf{关键词3} \quad \textbf{关键词4}\quad \textbf{关键词5}}
	\end{abstract}

	\clearpage %换页

	%正文部分
	%Part one
	\section{问题背景与重述}
	\subsection{问题背景}
	“板凳龙”是浙闽地区的传统民俗活动，其舞龙队能够将上百条板凳螺旋式盘绕形成巨龙。舞龙队的盘绕路线大致呈螺线状向内部盘绕。其中，螺距的最小化与速度的最大化不仅影响舞龙队形的紧凑度和动态美，也直接关系到表演的安全性。通过对这些参数的深入研究，可以优化舞龙表演的编排，确保参与者的安全，为传统文化的传承与发展提供科学支撑。

	%\begin{figure}[H]
	%	\centering %图片居中
	%	\captionsetup{skip=4pt} % 设置标题与表格的间距为4pt
	%	\includegraphics[width=10cm]{图片文件名} %width设置图片大小
	%	\caption{商超蔬菜示意图\label{商超蔬菜示意图}} %设置图片的标题及引用标签
	%\end{figure}

	\subsection{问题重述}
		\textbf{问题一：}在题目给定的 55cm 螺距的等距螺线作为行进路线的情形下，取龙头位置为第十六圈与 x 轴交点处为龙头的初始位置，且龙头以 1m/s 的速度向内顺时针盘绕，计算 0-300s 内每隔一秒舞龙队各把手的所在位置以及速度。

		\textbf{问题二：}在题目给定的 55cm 螺距的等距螺线作为行进路线的情形下，取龙头位置为第十六圈与 x 轴交点处为龙头的初始位置，且龙头以 1m/s 的速度向内顺时针盘绕。求解板凳间首次发生碰撞的时刻，进一步求解该时刻各个把手的位置坐标和速度。

		\textbf{问题三：}优化等距螺线的螺距，使得舞龙队首次发生碰撞的位置位于以等距螺线中心为圆心，9m为直径的圆的外部。在此约束条件下求等距螺线螺距的最小值。

		\textbf{问题四：}在题目给定的掉头路线的基础上，试寻找符合要求的掉头路线使路线长度更短。同时，在题目指定的掉头路线基础上，求解舞龙队各把手在 -100s 到 100s 内每一秒的位置和速度。

		\textbf{问题五：}

	%Part Two
	\section{问题分析}
	\subsection{问题一的分析}
		问题一要求我们在给定情景下分析从初始时刻到 300s 为止的时间中舞龙队各把手的中心位置和速度。首先，需要推导出了描述等距螺线路径与速度关系的微分方程，并解出了龙头位置与行进时间的函数关系。接着，需要利用已知的把手位置，采用了二分查找算法，迭代地确定了舞龙队所有把手的具体物理位置，从而计算出每一把手在不同时间点的位置。然后，需要应用微元法分析了舞龙队各把手的位置变化，从而得出了它们的速度。
	\subsection{问题二的分析}
        问题二要求我们确定板凳之间首次发生碰撞时各个把手的位置和速度。由于问题一模型的建立，已经建立了映射关系$t\to<pos_i,v_i>$。因此只需要计算板凳发生碰撞的最小时间。该问题可分解为两个小问题，首先是\textbf{给定所有点的位置格局，板凳是否碰撞的判定问题}，使用了向量代数和几何方法给出了判定，该问题的解答给出了优化模型的约束条件；其次是\textbf{搜索满足板凳碰撞约束条件的最小速度的优化问题}。结合满足约束条件的t在实数域内为\textbf{多个}连续区间这一特征，难以遍历搜索得到最小值，可以借鉴\textbf{多个}粒子分别搜索的\textbf{粒子群算法}，通过一定改造得到了本问题的求解方法。
	\subsection{问题三的分析}
        问题三要求我们找到最小的螺距，使得板凳龙首次碰撞时，龙头前把手位于中央半径为4.5m的圆内部。我们建立了以螺距为决策目标、首次碰撞时龙头距离圆心长度小于4.5m为约束条件的单目标优化模型。试探性地使用问题二中的求解方法计算出了不同螺距下板凳龙龙头距离原点的最小长度，通过可视化分析，得到最小长度与螺距呈现单调的函数关系。因此，直接采用二分查找的算法得到螺距的最小值。并通过运动的可视化验证了模型。
	\subsection{问题四的分析}
		问题四要求我们确定在给定行进路线下的舞龙队各把手在给定时间下的位置和行进速度。首先，需要计算出
	\subsection{问题五的分析}

	%Part Three
	\section{模型假设}
	%假设的列表
	\begin{enumerate}
		\item 假设板凳龙盘入与盘出时，龙头、各节龙身以及龙尾之间连接牢固，旋转润滑，运动连续不停顿
		\item 假设不考虑板凳厚度对板凳龙整体运动产生的影响
		\item 假设板凳龙的各板凳均位于同一平面上，不考虑板凳间搭接导致的板凳高度起伏，不考虑地面的高度起伏
            \item 假设运动模型中所有被纳入考虑的位置均空旷，不存在障碍物阻挡或不可到达的区域
            \item 在建立碰撞模型时，不考虑举板凳的人所占据的空间，假设舞龙队发生碰撞当且仅当板凳发生碰撞
	\end{enumerate}

	%Part Four
	\section{符号说明}
	%浮动体表格，使用table实现
	\begin{table}[H] %[h]表示在此处添加浮动体，默认为tbf，即页面顶部、底部和空白处添加
		\captionsetup{skip=4pt} % 设置标题与表格的间距为4pt
		\centering
		\setlength{\arrayrulewidth}{2pt} % 设置表格线条宽度为1pt
		\begin{tabular}{cc} %c表示居中，l表示左对齐，r表示右对齐，中间添加“|”表示竖线
			\hline
			\makebox[0.15\textwidth][c]{符号} & \makebox[0.6\textwidth][c]{说明}  \\
			\hline
			$\rho$ & 极坐标下点的模长  \\
			$\theta$ & 极坐标下点的辐角  \\
			$D$ & 等距螺线螺距  \\
			$L_1$ & 龙头板凳长  \\
			$L_2$ & 龙身龙尾板凳长  \\
			$d$ & 板凳宽  \\
			$l$ & 板凳板头长 \\
			$R$ & 掉头区域半径大小\\
			$r_1$ & 前一掉头圆弧半径\\
			$r_2$ & 后一掉头圆弧半径\\
			$t$ & 舞龙队运动时间  \\
			$A_0$ & 龙头把手的中心点  \\
			$A_i$ & 第 i 节龙身靠前把手的中心点  \\
			$A_{223}$ & 龙尾后侧把手中心点  \\
			$B$ & 掉头曲线起始位置 \\
			$B'$ & 掉头曲线结束位置 \\
			$l_B$ & 掉头曲线起始位置切线 \\
			\hline
		\end{tabular}
		% \hline是横线，采用\makebox设置列宽
	\end{table}


	%Part Five
	\section{模型的建立与求解}
	\subsection{问题一模型的建立与求解}
	\subsubsection{由龙头把手确定其余把手的位置}

		依据题意，舞龙队的行进路线由 $D = 55cm$ 的等距螺线确定。选用极坐标刻画行进路线时，该路线可以由以下方程确定：

		\begin{equation}
			\rho = \frac{D}{2\pi}\theta, \quad \theta \in [0,+\infty)
		\end{equation}

		使用形如 $(\rho, \theta)$ 的方式表示点的坐标，因此初始点 A 点的坐标可以表示为 $( 16 \cdot 0.55, 16 \cdot 2\pi )$。

		题设给定的初始条件中，只有龙头把手的位置是已知信息，因此需要得到龙头把手的位置和其余所有把手的位置关系才能确定其余把手的位置。通过解析可以发现：该关系难以求出解析解。因此可以考虑\textbf{从龙头把手位置逐级递推到每一把手的位置}。

		为了做到这一点，考虑到对给定的前一把手位置（$\theta_{i}$），当$\Delta \theta > \frac{\pi}{2}$时，$\Delta l$关于$\Delta \theta$递增，故我们选用了二分查找算法，在任一把手 $A_i$ 位置已知的情况下，查找下一把手所在位置。即给定 $\theta_{i}$ ，确定 $\theta_{i+1}$ 的大小。而 $\theta_{i+1}$ 合适当且仅当两把手的间距正好等于板凳两孔中心的距离。根据极坐标下的余弦定理，两点间的位置即为：

		$$\Delta l = \sqrt{\rho_i^2 + \rho_{i+1}^2 - 2\rho_i \rho_{i+1} \cos(\theta_i - \theta_{i+1})}$$

		代入 $\rho$ 并令 $\Delta l$ 分别减去龙头和龙身除去板头的长度，即分别减去 $L_1 - 2 \cdot l$ 和 $L_2 - 2 \cdot l$，即可得到二分查找的目标函数 $f$ ，其零点即为 $\theta_{i+1}$ 的二分查找值：

		\begin{equation}
			f(\theta) = \frac{D}{2\pi} \sqrt{\theta^2 + \theta_i^2 - 2\theta \theta_i \cos(\theta - \theta_i)} - (L_j - 2l), \quad j=1, 2
		\end{equation}

		目标函数 $f$ 二分查找所得的零点即为 $\theta_{i+1}$ 的数值解。

		二分求解代码见附录2 % TODO！！！！!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!11↑

	\subsubsection{确定龙头把手的位置与时间关系}

		5.1.1 小节提供了由龙头把手计算其余各个把手位置的方法，因此只需要确定每一秒龙头把手的位置，利用上一小节的方法，即可得到每一秒钟各个把手的位置信息。

		极坐标下，龙头把手位置可以由 $\theta$ 参数唯一确定。因此，只需要求解出龙头的辐角 $\theta$ 与时间 $t$ 的关系即可。对等距螺线使用微元法，可以用 $d\theta$ 和 $d\rho$ 表示出螺线弧微元 $ds$：

		$$ ds = \sqrt{(d\rho)^2 + (\rho d\theta) ^ 2}$$

		而微元 $ds$ 等于龙头在 $dt$ 时间内行进的距离，即：

		\begin{equation}
			\sqrt{(d\rho)^2 + (\rho d\theta) ^ 2} = vdt
		\end{equation}

		联立 (1) 和 (3) 式消去 $\rho$，用\textbf{分离变量法}求解\textbf{常微分方程}即可解得龙头的辐角 $\theta$ 和时间 $t$ 满足以下关系：

		\begin{equation}
			g(\theta) = \frac{D}{2\pi}(-\frac{1}{2}\ln(\sqrt{\theta^2+1}-\theta)+\frac{1}{2}\theta\sqrt{\theta^2+1})=vt+C
		\end{equation}

		% TODO 常数 C 需要进一步计算

		带入初值条件$$g(32  \pi) = C$$,利用数值计算即可求得给定时刻下龙头把手的位置。

	\subsubsection{确定各把手的速度}

		5.1.2 小节计算出了各个把手的位置在给定时刻下的数值解，而速度是位置在时间尺度下的微元。因此，只需要取时间微元 $\Delta t$ ，并计算在给定时间 $t_1$ 两侧的 $\Delta t$ 下的把手位置的位移模长 $|\vec{x}(t_1+\Delta t) - \vec{x}(t_1 - \Delta t)|$ ，将其除以两倍的 $\Delta t$ 即可得到速度大小。



		具体来说，对于给定的时间 $t_1$ ，把手 $A_i$ 此时的速度大小的数值解为：

		\begin{equation}
			v_{t1} = \frac{\sqrt{(x_i(t_1 + \Delta t) - x_i(t_1 - \Delta t))^2 + (y_i(t_1 + \Delta t) - y_i(t_1 - \Delta t))^2}}{2\Delta t}
		\end{equation}

		% TODO: \subsubsection{模型的检验}

		利用这种方式计算出问题一中的各个把手的位置和速度见 result1.xlsx 文件。其中 0 s、60 s、120 s、180 s、240 s、300 s 时，龙头前把手、龙头后面第 1、51、101、151、201 节龙身前把手和龙尾后把手的位置和速度如下表所示：


		\begin{table}[H] %[h]表示在此处添加浮动体，默认为tbf，即页面顶部、底部和空白处添加
			\captionsetup{skip=4pt} % 设置标题与表格的间距为4pt
			\caption{问题一的位置结果}
			\centering
			\setlength{\arrayrulewidth}{0.5pt} % 设置表格线条宽度为1pt
			\begin{tabular}{|c|c|c|c|c|c|c|} %c表示居中，l表示左对齐，r表示右对齐，中间添加“|”表示竖线
				\hline
				% \makebox[0.15\textwidth][c]{符号} & \makebox[0.6\textwidth][c]{说明}  \\
				% \hline
				& 0 s & 60 s & 120 s & 180 s & 240 s & 300 s \\ \hline
				龙头 x (m)         & 8.800000 &	5.799209 &	-4.084887 &	-2.963609 &	-0.818702 &	4.420274 \\ \hline
				龙头 y (m)         & -0.000000 &	-5.771092 &	-6.304479 &	6.094780 &	5.590600 &	2.320429 \\ \hline
				第 1 节龙身 x (m)  & 8.363824 &	7.456758 &	-1.445473 &	-5.237118 &	-3.469210 &	2.459489 \\ \hline
				第 1 节龙身 y (m)  & 2.826544 &	-3.440399 &	-7.405883 &	4.359627 &	4.516167 &	4.402476 \\ \hline
				第 51 节龙身 x (m) & -9.518732 &	-8.686317 &	-5.543150 &	2.890455 &	-6.560125 &	-6.301346 \\ \hline
				第 51 节龙身 y (m) & 1.341137 &	2.540108 &	6.377946 &	7.249289 &	1.969759 &	0.465829 \\ \hline
				第 101 节龙身 x (m) &2.913983 &	5.687116 &	5.361939 &	1.898794 &	0.218823 &	-6.237722 \\ \hline
				第 101 节龙身 y (m) &-9.918311 &	-8.001384 &	-7.557638 &	-8.471614 &	7.831999 &	3.936008 \\ \hline
				第 151 节龙身 x (m) &10.861726 &	6.682311 &	2.388757 &	1.005154 &	4.451294 &	7.040740 \\ \hline
				第 151 节龙身 y (m) &1.828753 &	8.134544 &	9.727411 &	9.424751 &	-7.486030 &	4.393013 \\ \hline
				第 201 节龙身 x (m) &4.555102 &	-6.619664 &	-10.627211 &	-9.287720 &	-1.731014 &	-7.458662 \\ \hline
				第 201 节龙身 y (m) &10.725118 &	9.025570 &	1.359847 &	-4.246673 &	9.344557 &	-5.263384 \\ \hline
				龙尾（后） x (m)    &-5.305444 &	7.364557 &	10.974348 &	7.383896 &	7.057739 &	1.785033 \\ \hline
				龙尾（后） y (m)    &-10.676584 &	-8.797992 &	0.843473 &	7.492370 &	-6.846021 &	9.301164 \\ \hline
			\end{tabular}
			% \hline是横线，采用\makebox设置列宽
		\end{table}

		\begin{table}[H] %[h]表示在此处添加浮动体，默认为tbf，即页面顶部、底部和空白处添加
		\captionsetup{skip=4pt} % 设置标题与表格的间距为4pt
		\caption{问题一的速度结果}
		\centering
		\setlength{\arrayrulewidth}{0.5pt} % 设置表格线条宽度为1pt
		\begin{tabular}{|c|c|c|c|c|c|c|} %c表示居中，l表示左对齐，r表示右对齐，中间添加“|”表示竖线
			\hline
			% \makebox[0.15\textwidth][c]{符号} & \makebox[0.6\textwidth][c]{说明}  \\
			% \hline
			& 0 s & 60 s & 120 s & 180 s & 240 s & 300 s \\ \hline
			龙头 (m/s)      &    1.000000 &	1.000000 &	1.000000 &	1.000000 &	1.000000 &	1.000000 \\ \hline
			第 1 节龙身 (m/s) &  0.999971 &	0.999961 &	0.999945 &	0.999917 &	0.999859 &	0.999709 \\ \hline
			第 51 节龙身 (m/s) & 0.999742 &	0.999662 &	0.999540 &	0.999331 &	0.998940 &	0.998064 \\ \hline
			第 101 节龙身 (m/s) &0.999575 &	0.999455 &	0.999277 &	0.998971 &	0.998436 &	0.997302 \\ \hline
			第 151 节龙身 (m/s) &0.999451 &	0.999303 &	0.999082 &	0.998726 &	0.998121 &	0.996860 \\ \hline
			第 201 节龙身 (m/s) &0.999352 &	0.999190 &	0.998942 &	0.998552 &	0.997902 &	0.996575 \\ \hline
			龙尾（后） (m/s) &   0.999317 &	0.999143 &	0.998889 &	0.998490 &	0.997827 &	0.996476 \\ \hline
		\end{tabular}
		% \hline是横线，采用\makebox设置列宽
		\end{table}

		相关系数矩阵模版:

		\begin{gather*}
			\begin{bmatrix}
				Variable & a & b & c & d & e & f \\
				a & 1 & 1 & 1 & 1 & 1 & 1 \\
				b & 1 & 1 & 1 & 1 & 1 & 1 \\
				c & 1 & 1 & 1 & 1 & 1 & 1 \\
				d & 1 & 1 & 1 & 1 & 1 & 1 \\
				e & 1 & 1 & 1 & 1 & 1 & 1 \\
				f & 1 & 1 & 1 & 1 & 1 & 1 \\
			\end{bmatrix}
		\end{gather*}


	\subsection{问题二模型的建立与求解}
	     针对问题二，我们建立了以板凳龙运动的最长时间为决策变量和目标函数，以板凳间不互相碰撞为约束条件的最优化模型。通过向量代数和计算几何方法将约束条件转化为跨立实验。使用了模拟粒子群算法对最优化问题进行启发式求解。

        \subsubsection{板凳碰撞最优化模型的建立}
        % \subsubsubsection{边界坐标的确定}
        问题一模型确立了$t\to<pos_i,v_i>$的映射关系，故能够由时刻确定所有把手$A_{i}$位置，即$A_{i}$为t的函数，记作$A_{i}(t)$。下面建立向量代数模型，确定板凳四边界点同板凳把手$A_i(t)$的解析关系。
        % \subsubsubsection{线段相交模型的建立}
        % \subsubsubsection{跨立实验判定线段相交}
        % \subsubsubsection{最优化模型的建立}
		以板凳龙的运动总时长t为决策变量和目标函数，结合上述线段不相交条件，最终建立了如下的单目标规划函数（其中$\phi$1-4由 /* TODO*/ 式定义）：
		\begin{equation}
			\begin{aligned}
				& \max \quad \quad t \\
				& \text { s.t. }\left\{\begin{array}{l}
                        B_i(t) = \phi_1(A_i(t), A_{i + 1}(t))\\
                        B_{i + 1}(t) = \phi_2(A_i(t), A_{i + 1}(t))\\
                        C_i(t) = \phi_3(A_i(t), A_{i + 1}(t))\\
                        C_{i + 1}(t) = \phi_4(A_i(t), A_{i + 1}(t))\\
               \underset{i=0}{\overset{222}{\bigcup}}\quad \underset{0\leq j \leq i - 2}{\bigcup}(\overline{B_i(t)B_{i + 1}(t)} \bigcap \overline{C_j(t)C_{j + 1}(t)}) = \emptyset

  \\
					% Z_k=\frac{Y_{i, y} \cdot \beta_k}{1-\alpha_k} \\
					% S_k=X_{2, y}\left(1+V_k\right)\left(1+\beta_k\right) \\
					% \beta_k \in\{1, c\} \\
					% c>1 \\

				\end{array}\right.
			\end{aligned}
		\end{equation}
	\subsubsection{使用拟粒子群算法进行的模型求解}
        \subsubsection{使用问题一运动模型求解各把手位置坐标和速度}
	\subsection{问题三模型的建立与求解}
	\subsubsection{最优化模型的建立}
        \subsubsection{模型的二分查找求解}
	\subsection{问题四模型的建立与求解}
	
		% TODO: 先说明我们是用题目中叙述的圆弧来进行建模，再叙述建模求解过程
		依据题意，在满足各部分相切，且前一圆弧的半径是后一圆弧半径的两倍的条件下，两圆弧的位置仅由进入和离开掉头区域的位置及方向唯一确定。因此，\textbf{两圆弧的位置不能再优化}。下面将逐步\textbf{确定圆弧的位置}、建立舞龙队\textbf{行进路线的参数方程}，最终计算得到\textbf{舞龙队各把手的位置和速度}。% TODO
		
		\subsubsection{确定掉头曲线}
		
		依据题意，为了确定掉头曲线的方程使得各部分相切，\textbf{需要先求出掉头曲线的起始、结束位置的坐标和切线斜率}。
		并在此基础上\textbf{求解两圆弧的圆心位置即半径}
		
		由于盘出螺线和盘入螺线呈中心对称，盘入盘出螺线的极坐标方程可以表示为：
		
		\begin{equation}
			\rho = \frac{D}{2\pi} \theta
		\end{equation}
		
		\begin{equation}
			\rho = \frac{D}{2\pi} (\theta - \pi)
		\end{equation}
		
		而掉头区域是直径为 $R = 9$ 米的圆形区域，其圆心为原点。其极坐标方程可以表示为：
		
		\begin{equation}
			\rho = R
		\end{equation}
		
		分别联立两螺线方程和圆方程可以解得掉头区域的入口 $B$ 和出口 $B'$ 的极坐标分别为：
		$$ B(\rho, \theta) = (R, \theta_0) = (4.5, 16.631961) $$
		$$ B'(\rho, \theta) = (R, \theta_0 + \pi) = (4.5, 19.773553)$$
		换算成直角坐标即（单位：米）：
		$$ (x_0, y_0) = (-2.711855, -3.591077) $$
		$$ (x_0', y_0') = (2.711855, 3.591077) $$
		确定了点 $B$ 和点 $B'$ 后，还需要确定进入掉头区域时的速度方向，用以计算相切条件。由盘入盘出螺线的中心对称性可知两点处的切线平行，斜率相同，因此只需要计算盘入曲线的切线斜率 $k$ 。
		
		盘入曲线的直角坐标表达式为：
		
		\begin{align}
			\left\{
			\begin{aligned}
				x &= \rho \cos(\theta) = \frac{D}{2\pi} \theta \cos(\theta) \\
				y &= \rho \sin(\theta) = \frac{D}{2\pi} \theta \sin(\theta)
			\end{aligned}
			\right.
		\end{align}
		
		在直角坐标系下取 $y$ 对 $x$ 的微分即可得到掉头曲线起始位置和结束为止的切线斜率：
		
		\begin{equation}
			k = \frac{dy}{dx}\Bigg|_{\theta=\theta_0} = \frac{dy}{d\theta} \frac{1}{\frac{dx}{d\theta}} \Bigg|_{\theta=\theta_0} = \frac{\sin\theta_0 + \theta_0 \cos(\theta_0)}{\cos(\theta_0) - \theta_0 \sin(\theta_0)}
		\end{equation}
		
		\begin{figure}[h]
			\centering
			\includegraphics[width=0.5\textwidth]{image/Figure_5411.png}
			\caption{掉头曲线示意}
			\label{Figure_5411}
		\end{figure}
		
		如图所示 % TODO
		设前一圆弧圆心为 $O_1$ 后一圆弧圆心为 $O_2$ ，掉头曲线的起始位置和结束位置分别为点 $B$ 和点 $B'$ 。延长 $B O_1$ 至点 $O'$ 使得 $O_1O' = O_2B'$ 。设前一圆弧半径为 $r_1$ ，后一圆弧半径为 $r_2$ ，则有 $r_1 = 2r_2$ 。舞龙队的沿 $\overset{\frown}{B_1 P}$, $\overset{\frown}{PB_2}$行进。 连接 $O'B'$ 可知四边形 $O'B'O_2O1$ 为平行四边形，因此有： 
		$$ O'B'= O_1O_2 = r_1 + r_2 = 3r_2 = BO_1 + O_1O' = O'B$$
		同时，由于第一段圆弧是和盘入螺线相切的，因此设 $B$ 点处的切线为 $l_B$ 则有 $O'B \perp l_B$。而 $l_B$ 的斜率为 $k$ ，因此 $O'B$ 的斜率为 $-\frac{1}{k}$ 。联立：
		\begin{align}
			\left\{
			\begin{aligned}
				O'B'=O'B \\
				\frac{x_{O'} - x_B}{y_{O'} - y_B} = -\frac{1}{k}
			\end{aligned}
			\right.
		\end{align}
		即可解得点 $O'(0.215914, -0.163050)$ 。然后，由 $\overrightarrow{OO_1} = \overrightarrow{OB_1} + 2\overrightarrow{O_1O}$ ， $\overrightarrow{OO_2} = \overrightarrow{OB_2} + \overrightarrow{O'O}$ 即可解得两圆弧的圆心坐标 $O_1(x_1, y_1)$ $O_2(x_2, y_2)$
	
	\subsubsection{确定舞龙队行进路线的参数方程}
	
		5.4.1 节得到了舞龙队行进路线中各部分路线的具体位置、参数，但是却没有将各部分曲线合并在一起，给问题四的舞龙队的速度和位置计算带来的挑战。因此，需要建立合适的参数方程来刻画整一条行进路线，即给定现实的时间 $t$ 作为参数，需要能够得到行进路线上点的参数。同时，由于龙头在任一时刻下位置就是这条曲线的参数方程，因此可以\textbf{使用龙头把手的位置与时间的函数关系作为舞龙队行进路线的参数方程}。
		
		分析可知，舞龙队的行进路线可以分为四部分：盘入阶段、前圆弧阶段、后圆弧阶段和盘出阶段。前圆弧阶段和后圆弧阶段过渡的时间节点在 $t1$ 时刻，后圆弧阶段和盘出阶段过渡的时间节点在 $t2$ 时刻。类似问题一的求解过程可以得到盘入阶段的极坐标方程为：
		
		\begin{equation}
			(\frac{1}{2}\ln(\sqrt{1 + \theta^2} - \theta) - \frac{1}{2} \theta \sqrt{\theta^2 + 1}) \frac{D}{2 \pi} - vt + C_0 = 0, \quad t \le 0
		\end{equation}
		
		在求出方程数值解后，只需要将极坐标换算成直角坐标，即可得到盘入阶段下，给定时刻 $t$ 下龙头把手的位置。
		
		对于前圆弧，只需要在直角坐标系下将圆弧转换为\textbf{圆的参数方程}即可。考虑到前圆弧的运动方向是顺时针，因此参数方程中的角速度应当为负数，即 $w = -\frac{v}{r_1}$ 
		
		\begin{equation}
			\begin{aligned}
				\left\{
					\begin{array}{l}
						x = x_1 + r_1 \cos(\theta_1 - \frac{v}{r_1}t) \\
						y = y_1 + r_1 \sin(\theta_1 - \frac{v}{r_1}t) \\
					\end{array}
				\right.
			\end{aligned}
			, \quad 0 < t \le t_1
		\end{equation}
		
		后圆弧的计算过程与前圆弧类似。考虑到后圆弧是逆时针运动，角速度应当为正，即 $w = \frac{v}{r_2} $：
		
		\begin{equation}
			\begin{aligned}
				\left\{
				\begin{array}{l}
					x = x_2 + r_2 \cos(\theta_2 - \frac{v}{r_2}t) \\
					y = y_2 + r_2 \sin(\theta_2 - \frac{v}{r_2}t) \\
				\end{array}
				\right.
			\end{aligned}
			, \quad t_1 < t \le t_2
		\end{equation}
		
		在给定初相下即可得到两圆弧的参数方程。利用解析几何可计算出前圆弧参数方程中初相 $\theta_1$ 以及后圆弧参数方程的初相 $\theta_2$ 即可确定两圆弧的参数方程。
		
		对于盘出阶段，可以类似盘入阶段进行数值计算，得到盘出阶段在极坐标下位置和时间的关系：
		
		\begin{equation}
			(- \frac{1}{2}\ln(\sqrt{1 + \theta^2} - \theta) + \frac{1}{2} \theta \sqrt{\theta^2 + 1}) \frac{D}{2 \pi} - vt + C_3 = 0, \quad t > t_2
		\end{equation}
		
		综上，对舞龙队各部分路线参数方程进行汇总即可得到总的参数方程，记录在附件%TODO
		的 t\_to\_xy\_q4() 函数中。对该函数进行绘制即可得到舞龙队的行进路线，如图%TODO
		所示。
		
		\begin{figure}[h]
			\centering
			\includegraphics[width=0.7\textwidth]{image/Figure_5412.png}
			\caption{问题四舞龙队行进路线}
			\label{Figure_5412}
		\end{figure}
	
	\subsubsection{求解舞龙队的速度和位置}
	
	利用舞龙队行进路线的参数方程，以及龙头把手位置与时间的关系后，结合问题一的\textbf{二分查找算法}和\textbf{微元法}即可得到舞龙队行进的速度和位置。其中，− 100 s、− 50 s、0 s、50 s、100 s 时，龙头前把手、龙头后面第 1、
	51、101、151、201 节龙身前把手和龙尾后把手的位置和速度如表%TODO
	所示。
	
	\begin{table}[H] %[h]表示在此处添加浮动体，默认为tbf，即页面顶部、底部和空白处添加
		\captionsetup{skip=4pt} % 设置标题与表格的间距为4pt
		\caption{问题一的位置结果}
		\centering
		\setlength{\arrayrulewidth}{0.5pt} % 设置表格线条宽度为1pt
		\begin{tabular}{|c|c|c|c|c|c|} %c表示居中，l表示左对齐，r表示右对齐，中间添加“|”表示竖线
			\hline
			% \makebox[0.15\textwidth][c]{符号} & \makebox[0.6\textwidth][c]{说明}  \\ 
			% \hline
			& -100 s & -50 s & 0 s & 50 s & 100 s \\ \hline
			龙头 x (m)          & 8.800000 &	5.799209 &	-4.084887 &	-2.963609 &	-0.818702 \\ \hline
			龙头 y (m)          & -0.000000 &	-5.771092 &	-6.304479 &	6.094780 &	5.590600 \\ \hline
			第 1 节龙身 x (m)   & 8.363824 &	7.456758 &	-1.445473 &	-5.237118 &	-3.469210 \\ \hline
			第 1 节龙身 y (m)   & 2.826544 &	-3.440399 &	-7.405883 &	4.359627 &	4.516167 \\ \hline
			第 51 节龙身 x (m)  & -9.518732 &	-8.686317 &	-5.543150 &	2.890455 &	-6.560125 301346 \\ \hline
			第 51 节龙身 y (m)  & 1.341137 &	2.540108 &	6.377946 &	7.249289 &	1.969759 \\ \hline
			第 101 节龙身 x (m) & 2.913983 &	5.687116 &	5.361939 &	1.898794 &	0.218823 \\ \hline
			第 101 节龙身 y (m) & -9.918311 &	-8.001384 &	-7.557638 &	-8.471614 &	7.831999 \\ \hline
			第 151 节龙身 x (m) & 10.861726 &	6.682311 &	2.388757 &	1.005154 &	4.451294 \\ \hline
			第 151 节龙身 y (m) & 1.828753 &	8.134544 &	9.727411 &	9.424751 &	-7.486030 \\ \hline
			第 201 节龙身 x (m) & 4.555102 &	-6.619664 &	-10.627211 &	-9.287720 &	-1.731014 \\ \hline
			第 201 节龙身 y (m) & 10.725118 &	9.025570 &	1.359847 &	-4.246673 &	9.344557 \\ \hline
			龙尾（后） x (m)    & -5.305444 &	7.364557 &	10.974348 &	7.383896 &	7.057739 \\ \hline
			龙尾（后） y (m)    & -10.676584 &	-8.797992 &	0.843473 &	7.492370 &	-6.846021 \\ \hline
		\end{tabular}
		% \hline是横线，采用\makebox设置列宽
	\end{table}
	
	\begin{table}[H] %[h]表示在此处添加浮动体，默认为tbf，即页面顶部、底部和空白处添加
		\captionsetup{skip=4pt} % 设置标题与表格的间距为4pt
		\caption{问题一的速度结果}
		\centering
		\setlength{\arrayrulewidth}{0.5pt} % 设置表格线条宽度为1pt
		\begin{tabular}{|c|c|c|c|c|c|} %c表示居中，l表示左对齐，r表示右对齐，中间添加“|”表示竖线
			\hline
			% \makebox[0.15\textwidth][c]{符号} & \makebox[0.6\textwidth][c]{说明}  \\ 
			% \hline
			& -100 s & -50 s & 0 s & 50 s & 100 s \\ \hline
			龙头 (m/s)          & 1.000000 & 1.000000 & 1.000000 & 1.000000 & 1.000000 \\ \hline
			第 1 节龙身 (m/s)   & 0.999971 & 0.999961 & 0.999945 & 0.999917 & 0.999859 \\ \hline
			第 51 节龙身 (m/s)  & 0.999742 & 0.999662 & 0.999540 & 0.999331 & 0.998940 \\ \hline
			第 101 节龙身 (m/s) & 0.999575 & 0.999455 & 0.999277 & 0.998971 & 0.998436 \\ \hline
			第 151 节龙身 (m/s) & 0.999451 & 0.999303 & 0.999082 & 0.998726 & 0.998121 \\ \hline
			第 201 节龙身 (m/s) & 0.999352 & 0.999190 & 0.998942 & 0.998552 & 0.997902 \\ \hline
			龙尾（后） (m/s)    & 0.999317 &	0.999143 & 0.998889 & 0.998490 & 0.997827 \\ \hline
		\end{tabular}
		% \hline是横线，采用\makebox设置列宽
	\end{table}
	
	\subsection{问题五模型的建立与求解}
	
	
	%Part Six
	\section{模型的评价、改进与推广}
	\subsection{模型优点}
	\begin{enumerate}
		\item 
		\item 
		\item 
		\item 
	\end{enumerate}
	
	\subsection{模型缺点}
	\begin{enumerate}
		\item 
		\item 
		\item 
	\end{enumerate}
	
	\subsection{模型的改进}
	\begin{enumerate}
		\item 
		\item 
		\item 
	\end{enumerate}
	
	%Part Seven
	\section{参考文献}
	\vspace{-2em} % 减小上面的间距
	\begin{thebibliography}{9}  
		\bibitem{ref1} 
		\bibitem{ref2} 
		\bibitem{ref3} 
		\bibitem{ref4}   
	\end{thebibliography}
	
	\newpage
	\section*{附录}
	
	附录1：支撑材料的文件列表
	
	
	附录2：初始化代码和数据处理代码
	\begin{lstlisting}[language=python,columns=fullflexible,frame=shadowbox]
		import pandas as pd
		import warnings
		import xlwt
		import numpy as np
		import matplotlib.pyplot as plt
		import pylab
		import seaborn as sns
		from pylab import mpl
		from sklearn.preprocessing import PolynomialFeatures
		from sklearn import linear_model
		from sklearn.model_selection import train_test_split
		from sklearn.ensemble import RandomForestRegressor
		from sklearn import metrics
		import statsmodels.api as sm
		import geatpy as ea
		from scipy import  optimize as opt
		from scipy.optimize import minimize
	\end{lstlisting}
	
\end{document}